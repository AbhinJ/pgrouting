<!DOCTYPE html>

<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>pgr_trsp - Camino más corto con giros restringidos (TRSP) &#8212; pgRouting Manual (3.4-dev)</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/translations.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="index" title="Índice" href="genindex.html" />
    <link rel="search" title="Búsqueda" href="search.html" />
    <link rel="next" title="Costo - Categoría" href="cost-category.html" />
    <link rel="prev" title="Rutas más cortas K - Categoría" href="KSP-category.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="_static/js/jquery-1.12.4.min.js "></script>
<script type="text/javascript" src="_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="_static/bootstrap-3.4.1/js/bootstrap.min.js "></script>
<script type="text/javascript" src="_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html"><span><img src="_static/pgrouting.png"></span>
          pgRouting</a>
        <span class="navbar-text navbar-version pull-left"><b>v3.4.0-dev</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="pgRouting-introduction.html">Introducción</a></li>
<li class="toctree-l1"><a class="reference internal" href="pgRouting-installation.html">Instalación</a></li>
<li class="toctree-l1"><a class="reference internal" href="support.html">Soporte</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="sampledata.html">Datos Muestra</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="pgRouting-concepts.html">Conceptos de pgRouting</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="pgr_version.html">pgr_version</a></li>
<li class="toctree-l1"><a class="reference internal" href="pgr_full_version.html">pgr_full_version</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="routingFunctions.html">Familias de Funciones</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="proposed.html">Funciones propuestas</a></li>
<li class="toctree-l1"><a class="reference internal" href="experimental.html">Funciones Experimentales</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="release_notes.html">Notas de versión</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">pgr_trsp - Camino más corto con giros restringidos (TRSP)</a><ul>
<li><a class="reference internal" href="#description">Descripción</a></li>
<li><a class="reference internal" href="#signatures">Signatures</a><ul>
<li><a class="reference internal" href="#one-to-one">One to One</a></li>
<li><a class="reference internal" href="#one-to-many">One to many</a></li>
<li><a class="reference internal" href="#many-to-one">Many to One</a></li>
<li><a class="reference internal" href="#many-to-many">Many to Many</a></li>
<li><a class="reference internal" href="#combinations">Combinations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#parameters">Parameters</a></li>
<li><a class="reference internal" href="#inner-queries">Inner queries</a><ul>
<li><a class="reference internal" href="#edges-sql">Edges SQL</a></li>
<li><a class="reference internal" href="#restrictions-sql">Restrictions SQL</a></li>
<li><a class="reference internal" href="#combinations-sql">Combinations SQL</a></li>
</ul>
</li>
<li><a class="reference internal" href="#return-columns">Return Columns</a></li>
<li><a class="reference internal" href="#version-2-1-signatures">Version 2.1 signatures</a></li>
<li><a class="reference internal" href="#support-for-vias">Soporte para Vias</a></li>
<li><a class="reference internal" href="#additional-examples">Ejemplos Adicionales</a></li>
<li><a class="reference internal" href="#known-issues">Problemas conocidos</a><ul>
<li><a class="reference internal" href="#introduction">Introducción</a></li>
<li><a class="reference internal" href="#the-restrictions">Las restricciones</a></li>
<li><a class="reference internal" href="#the-vertices-signature-version-deprecated-on-v3-4">The «Vertices» signature version – deprecated on v3.4</a><ul>
<li><a class="reference internal" href="#different-ways-to-represent-no-path-found">Diferentes formas de representar “ninguna ruta encontrada”</a></li>
<li><a class="reference internal" href="#user-contradictions">Contradicciones de usuarios</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-edges-signature-version">La versión de firma «Edges»</a><ul>
<li><a class="reference internal" href="#id1">Diferentes formas de representar “ninguna ruta encontrada”</a></li>
<li><a class="reference internal" href="#paths-with-equal-number-of-vertices-and-edges">Rutas con igual número de vértices y aristas</a></li>
<li><a class="reference internal" href="#routing-from-to-same-location">Ruteo desde/hacia la misma ubicación</a></li>
<li><a class="reference internal" href="#id2">Contradicciones de usuarios</a></li>
<li><a class="reference internal" href="#using-a-points-of-interest-table">Uso de una tabla de puntos de interés</a></li>
<li><a class="reference internal" href="#routing-from-a-vertex-to-a-point">Ruteo desde un vértice a un punto</a></li>
</ul>
</li>
<li><a class="reference internal" href="#prototypes">Prototipos</a></li>
</ul>
</li>
<li><a class="reference internal" href="#see-also">Ver también</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="KSP-category.html" title="Previous Chapter: Rutas más cortas K - Categoría"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Rutas más cor...</span>
    </a>
  </li>
  <li>
    <a href="cost-category.html" title="Next Chapter: Costo - Categoría"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Costo - Categoría &raquo;</span>
    </a>
  </li>
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="line-block">
<div class="line"><br /></div>
</div>
<ul class="simple">
<li><p><strong>Versiones soportadas:</strong> <a class="reference external" href="https://docs.pgrouting.org/latest/es/pgr_trsp.html">Última</a> (<a class="reference external" href="https://docs.pgrouting.org/3.3/es/pgr_trsp.html">3.3</a>) <a class="reference external" href="https://docs.pgrouting.org/3.2/es/pgr_trsp.html">3.2</a> <a class="reference external" href="https://docs.pgrouting.org/3.1/es/pgr_trsp.html">3.1</a> <a class="reference external" href="https://docs.pgrouting.org/3.0/es/pgr_trsp.html">3.0</a></p></li>
<li><p><strong>Versiones no soportadas:</strong> <a class="reference external" href="https://docs.pgrouting.org/2.6/en/pgr_trsp.html">2.6</a> <a class="reference external" href="https://docs.pgrouting.org/2.5/en/pgr_trsp.html">2.5</a> <a class="reference external" href="https://docs.pgrouting.org/2.4/en/pgr_trsp.html">2.4</a> <a class="reference external" href="https://docs.pgrouting.org/2.3/en/src/trsp/doc/pgr_trsp.html">2.3</a> <a class="reference external" href="https://docs.pgrouting.org/2.2/en/src/trsp/doc/pgr_trsp.html">2.2</a> <a class="reference external" href="https://docs.pgrouting.org/2.1/en/src/trsp/doc/index.html">2.1</a> <a class="reference external" href="https://docs.pgrouting.org/2.0/en/src/trsp/doc/index.html">2.0</a></p></li>
</ul>
<section id="pgr-trsp-turn-restriction-shortest-path-trsp">
<h1><a class="toc-backref" href="#id3">pgr_trsp - Camino más corto con giros restringidos (TRSP)</a><a class="headerlink" href="#pgr-trsp-turn-restriction-shortest-path-trsp" title="Enlazar permanentemente con este título">¶</a></h1>
<p><code class="docutils literal notranslate"><span class="pre">pgr_trsp</span></code> — Devuelve el camino más corto con soporte para restricciones de giros</p>
<p class="rubric">Disponibilidad</p>
<ul class="simple">
<li><p>Version 3.4.0</p>
<ul>
<li><p>New <strong>Proposed</strong> signatures</p>
<ul>
<li><p>trsp(one to one)</p></li>
<li><p>trsp(one to many)</p></li>
<li><p>trsp(many to one)</p></li>
<li><p>trsp(many to many)</p></li>
<li><p>trsp(combinations)</p></li>
</ul>
</li>
<li><p>Signature <cite>pgr_trsp(text,integer,integer,boolean,boolean)</cite> is deprecated</p></li>
</ul>
</li>
<li><p>Versión 2.1.0</p>
<ul>
<li><p>Nuevo <em>Via</em> <strong>prototypes</strong></p>
<ul>
<li><p>pgr_trspViaVertices</p></li>
<li><p>pgr_trspViaEdges</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Versión 2.0.0</p>
<ul>
<li><p>Función <strong>oficial</strong></p></li>
</ul>
</li>
</ul>
<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#pgr-trsp-turn-restriction-shortest-path-trsp" id="id3">pgr_trsp - Camino más corto con giros restringidos (TRSP)</a></p>
<ul>
<li><p><a class="reference internal" href="#description" id="id4">Descripción</a></p></li>
<li><p><a class="reference internal" href="#signatures" id="id5">Signatures</a></p>
<ul>
<li><p><a class="reference internal" href="#one-to-one" id="id6">One to One</a></p></li>
<li><p><a class="reference internal" href="#one-to-many" id="id7">One to many</a></p></li>
<li><p><a class="reference internal" href="#many-to-one" id="id8">Many to One</a></p></li>
<li><p><a class="reference internal" href="#many-to-many" id="id9">Many to Many</a></p></li>
<li><p><a class="reference internal" href="#combinations" id="id10">Combinations</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#parameters" id="id11">Parameters</a></p></li>
<li><p><a class="reference internal" href="#inner-queries" id="id12">Inner queries</a></p>
<ul>
<li><p><a class="reference internal" href="#edges-sql" id="id13">Edges SQL</a></p></li>
<li><p><a class="reference internal" href="#restrictions-sql" id="id14">Restrictions SQL</a></p></li>
<li><p><a class="reference internal" href="#combinations-sql" id="id15">Combinations SQL</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#return-columns" id="id16">Return Columns</a></p></li>
<li><p><a class="reference internal" href="#version-2-1-signatures" id="id17">Version 2.1 signatures</a></p></li>
<li><p><a class="reference internal" href="#support-for-vias" id="id18">Soporte para Vias</a></p></li>
<li><p><a class="reference internal" href="#additional-examples" id="id19">Ejemplos Adicionales</a></p></li>
<li><p><a class="reference internal" href="#known-issues" id="id20">Problemas conocidos</a></p>
<ul>
<li><p><a class="reference internal" href="#introduction" id="id21">Introducción</a></p></li>
<li><p><a class="reference internal" href="#the-restrictions" id="id22">Las restricciones</a></p></li>
<li><p><a class="reference internal" href="#the-vertices-signature-version-deprecated-on-v3-4" id="id23">The «Vertices» signature version – deprecated on v3.4</a></p>
<ul>
<li><p><a class="reference internal" href="#different-ways-to-represent-no-path-found" id="id24">Diferentes formas de representar “ninguna ruta encontrada”</a></p></li>
<li><p><a class="reference internal" href="#user-contradictions" id="id25">Contradicciones de usuarios</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#the-edges-signature-version" id="id26">La versión de firma «Edges»</a></p>
<ul>
<li><p><a class="reference internal" href="#id1" id="id27">Diferentes formas de representar “ninguna ruta encontrada”</a></p></li>
<li><p><a class="reference internal" href="#paths-with-equal-number-of-vertices-and-edges" id="id28">Rutas con igual número de vértices y aristas</a></p></li>
<li><p><a class="reference internal" href="#routing-from-to-same-location" id="id29">Ruteo desde/hacia la misma ubicación</a></p></li>
<li><p><a class="reference internal" href="#id2" id="id30">Contradicciones de usuarios</a></p></li>
<li><p><a class="reference internal" href="#using-a-points-of-interest-table" id="id31">Uso de una tabla de puntos de interés</a></p></li>
<li><p><a class="reference internal" href="#routing-from-a-vertex-to-a-point" id="id32">Ruteo desde un vértice a un punto</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#prototypes" id="id33">Prototipos</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#see-also" id="id34">Ver también</a></p></li>
</ul>
</li>
</ul>
</div>
<section id="description">
<h2><a class="toc-backref" href="#id4">Descripción</a><a class="headerlink" href="#description" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Turn restricted shorthest path (TRSP) is an algorithm that recives
turn restrictions in form of a query like those found in
real world navigable road networks.</p>
<p>The main characteristics are:</p>
<ul class="simple">
<li><p>Automatic detection of <cite>reverse_cost</cite> column</p></li>
<li><p>Accepts ANY-INTEGER and ANY-NUMERICAL on input columns</p></li>
<li><p>All variations give as result the same columns</p></li>
</ul>
</section>
<section id="signatures">
<h2><a class="toc-backref" href="#id5">Signatures</a><a class="headerlink" href="#signatures" title="Enlazar permanentemente con este título">¶</a></h2>
<p class="rubric">Summary</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>pgr_trsp(Edges SQL, Restrictions SQL, start vid,  end vid  [, directed]) -- Proposed on v3.4
pgr_trsp(Edges SQL, Restrictions SQL, start vid,  end vids [, directed]) -- Proposed on v3.4
pgr_trsp(Edges SQL, Restrictions SQL, start vids, end vid  [, directed]) -- Proposed on v3.4
pgr_trsp(Edges SQL, Restrictions SQL, start vids, end vids [, directed]) -- Proposed on v3.4
pgr_trsp(Edges SQL, Restrictions SQL, Combinations SQL [, directed]) -- Proposed on v3.4
RETURNS SET OF (seq, path_seq, start_vid, end_vid, node, edge, cost, agg_cost)
OR EMPTY SET

pgr_trsp(sql text, source integer, target integer,
         directed boolean, has_rcost boolean [,restrict_sql text]) -- deprecated on v3.4
pgr_trsp(sql text, source_edge integer, source_pos float8, target_edge integer, target_pos float8,
         directed boolean, has_rcost boolean [,restrict_sql text])
RETURNS SETOF (seq, id1, id2, cost)

pgr_trspViaVertices(sql text, vids integer[],
         directed boolean, has_rcost boolean [, restrictions_sql text]) -- Prototype on v2.1
pgr_trspViaEdges(sql text, eids integer[], pcts float8[],
         directed boolean, has_rcost boolean [, turn_restrict_sql text]) -- Prototype on v2.1
RETURNS SETOF (seq, id1, id2, id3, cost)
</pre></div>
</div>
<section id="one-to-one">
<span id="index-0"></span><h3><a class="toc-backref" href="#id6">One to One</a><a class="headerlink" href="#one-to-one" title="Enlazar permanentemente con este título">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>pgr_trsp(Edges SQL, Restrictions SQL, start vid,  end vid  [, directed])
RETURNS SET OF (seq, path_seq, start_vid, end_vid, node, edge, cost, agg_cost)
OR EMPTY SET
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Ejemplo</dt>
<dd class="field-odd"><p>From vertex <span class="math notranslate nohighlight">\(2\)</span> to vertex  <span class="math notranslate nohighlight">\(3\)</span> on an <strong>undirected</strong> graph</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT * FROM pgr_trsp(
  $$SELECT id, source, target, cost, reverse_cost FROM edge_table$$,
  $$SELECT id, path, cost FROM new_restrictions$$,
  2, 3,
  false
);
 seq | path_seq | start_vid | end_vid | node | edge | cost | agg_cost
-----+----------+-----------+---------+------+------+------+----------
   1 |        1 |         2 |       3 |    2 |    2 |    1 |        0
   2 |        2 |         2 |       3 |    3 |   -1 |    0 |        1
(2 rows)

</pre></div>
</div>
</section>
<section id="one-to-many">
<span id="index-1"></span><h3><a class="toc-backref" href="#id7">One to many</a><a class="headerlink" href="#one-to-many" title="Enlazar permanentemente con este título">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>pgr_trsp(Edges SQL, Restrictions SQL, start vid,  end vids [, directed])
RETURNS SET OF (seq, path_seq, start_vid, end_vid, node, edge, cost, agg_cost)
OR EMPTY SET
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Ejemplo</dt>
<dd class="field-odd"><p>From vertex <span class="math notranslate nohighlight">\(2\)</span> to vertices <span class="math notranslate nohighlight">\(\{3, 5\}\)</span> on an <strong>undirected</strong> graph</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT * FROM pgr_trsp(
  $$SELECT id, source, target, cost FROM edge_table$$,
  $$SELECT id, path, cost FROM new_restrictions$$,
  2, ARRAY[3,5],
  false
);
 seq | path_seq | start_vid | end_vid | node | edge | cost | agg_cost
-----+----------+-----------+---------+------+------+------+----------
   1 |        1 |         2 |       3 |    2 |    4 |    1 |        0
   2 |        2 |         2 |       3 |    5 |    8 |  101 |        1
   3 |        3 |         2 |       3 |    6 |    5 |    1 |      102
   4 |        4 |         2 |       3 |    3 |   -1 |    0 |      103
   5 |        1 |         2 |       5 |    2 |    4 |    1 |        0
   6 |        2 |         2 |       5 |    5 |   -1 |    0 |        1
(6 rows)

</pre></div>
</div>
</section>
<section id="many-to-one">
<span id="index-2"></span><h3><a class="toc-backref" href="#id8">Many to One</a><a class="headerlink" href="#many-to-one" title="Enlazar permanentemente con este título">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>pgr_trsp(Edges SQL, Restrictions SQL, start vids,  end vid [, directed])
RETURNS SET OF (seq, path_seq, start_vid, end_vid, node, edge, cost, agg_cost)
OR EMPTY SET
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Ejemplo</dt>
<dd class="field-odd"><p>From vertices <span class="math notranslate nohighlight">\(\{2, 11\}\)</span> to vertex <span class="math notranslate nohighlight">\(5\)</span> on a <strong>directed</strong> graph</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT * FROM pgr_trsp(
  $$SELECT id, source, target, cost, reverse_cost FROM edge_table$$,
  $$SELECT id, path, cost FROM new_restrictions$$,
  ARRAY[2,11], 5
);
 seq | path_seq | start_vid | end_vid | node | edge | cost | agg_cost
-----+----------+-----------+---------+------+------+------+----------
   1 |        1 |         2 |       5 |    2 |    4 |    1 |        0
   2 |        2 |         2 |       5 |    5 |   -1 |    0 |        1
   3 |        1 |        11 |       5 |   11 |   13 |    1 |        0
   4 |        2 |        11 |       5 |   12 |   15 |    1 |        1
   5 |        3 |        11 |       5 |    9 |    9 |    1 |        2
   6 |        4 |        11 |       5 |    6 |    8 |    1 |        3
   7 |        5 |        11 |       5 |    5 |   -1 |    0 |        4
(7 rows)

</pre></div>
</div>
</section>
<section id="many-to-many">
<span id="index-3"></span><h3><a class="toc-backref" href="#id9">Many to Many</a><a class="headerlink" href="#many-to-many" title="Enlazar permanentemente con este título">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>pgr_trsp(Edges SQL, Restrictions SQL, start vids,  end vids [, directed])
RETURNS SET OF (seq, path_seq, start_vid, end_vid, node, edge, cost, agg_cost)
OR EMPTY SET
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Ejemplo</dt>
<dd class="field-odd"><p>From vertices <span class="math notranslate nohighlight">\(\{2, 11\}\)</span> to vertices <span class="math notranslate nohighlight">\(\{3, 5\}\)</span> on an <strong>undirected</strong> graph</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT * FROM pgr_trsp(
  $$SELECT id, source, target, cost, reverse_cost FROM edge_table$$,
  $$SELECT id, path, cost FROM new_restrictions$$,
  ARRAY[2,11], ARRAY[3,5],
  false
);
 seq | path_seq | start_vid | end_vid | node | edge | cost | agg_cost
-----+----------+-----------+---------+------+------+------+----------
   1 |        1 |         2 |       3 |    2 |    2 |    1 |        0
   2 |        2 |         2 |       3 |    3 |   -1 |    0 |        1
   3 |        1 |         2 |       5 |    2 |    4 |    1 |        0
   4 |        2 |         2 |       5 |    5 |   -1 |    0 |        1
   5 |        1 |        11 |       3 |   11 |   11 |    1 |        0
   6 |        2 |        11 |       3 |    6 |    5 |    1 |        1
   7 |        3 |        11 |       3 |    3 |   -1 |    0 |        2
   8 |        1 |        11 |       5 |   11 |   11 |    1 |        0
   9 |        2 |        11 |       5 |    6 |    8 |    1 |        1
  10 |        3 |        11 |       5 |    5 |   -1 |    0 |        2
(10 rows)

</pre></div>
</div>
</section>
<section id="combinations">
<span id="index-4"></span><h3><a class="toc-backref" href="#id10">Combinations</a><a class="headerlink" href="#combinations" title="Enlazar permanentemente con este título">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>pgr_trsp(Edges SQL, Restrictions SQL, Combinations SQL [, directed])
RETURNS SET OF (seq, path_seq, start_vid, end_vid, node, edge, cost, agg_cost)
OR EMPTY SET
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Ejemplo</dt>
<dd class="field-odd"><p>Using a combinations table on an <strong>undirected</strong> graph</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT * FROM pgr_dijkstra(
  $$SELECT id, source, target, cost, reverse_cost FROM edge_table$$,
  $$SELECT * FROM (VALUES (2, 3), (2, 5), (11, 3), (11, 5)) AS combinations (source, target)$$
);
 seq | path_seq | start_vid | end_vid | node | edge | cost | agg_cost
-----+----------+-----------+---------+------+------+------+----------
   1 |        1 |         2 |       3 |    2 |    4 |    1 |        0
   2 |        2 |         2 |       3 |    5 |    8 |    1 |        1
   3 |        3 |         2 |       3 |    6 |    9 |    1 |        2
   4 |        4 |         2 |       3 |    9 |   16 |    1 |        3
   5 |        5 |         2 |       3 |    4 |    3 |    1 |        4
   6 |        6 |         2 |       3 |    3 |   -1 |    0 |        5
   7 |        1 |         2 |       5 |    2 |    4 |    1 |        0
   8 |        2 |         2 |       5 |    5 |   -1 |    0 |        1
   9 |        1 |        11 |       3 |   11 |   13 |    1 |        0
  10 |        2 |        11 |       3 |   12 |   15 |    1 |        1
  11 |        3 |        11 |       3 |    9 |   16 |    1 |        2
  12 |        4 |        11 |       3 |    4 |    3 |    1 |        3
  13 |        5 |        11 |       3 |    3 |   -1 |    0 |        4
  14 |        1 |        11 |       5 |   11 |   13 |    1 |        0
  15 |        2 |        11 |       5 |   12 |   15 |    1 |        1
  16 |        3 |        11 |       5 |    9 |    9 |    1 |        2
  17 |        4 |        11 |       5 |    6 |    8 |    1 |        3
  18 |        5 |        11 |       5 |    5 |   -1 |    0 |        4
(18 rows)

</pre></div>
</div>
</section>
</section>
<section id="parameters">
<h2><a class="toc-backref" href="#id11">Parameters</a><a class="headerlink" href="#parameters" title="Enlazar permanentemente con este título">¶</a></h2>
<table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 17%" />
<col style="width: 8%" />
<col style="width: 55%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Descripción</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Edges SQL</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">TEXT</span></code></p></td>
<td></td>
<td><p><a class="reference internal" href="#edges-sql">Edges SQL</a> as described below</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Restrictions SQL</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">TEXT</span></code></p></td>
<td></td>
<td><p><a class="reference internal" href="#restrictions-sql">Restrictions SQL</a> as described below</p></td>
</tr>
<tr class="row-even"><td><p><strong>Combinations SQL</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">TEXT</span></code></p></td>
<td></td>
<td><p><a class="reference internal" href="#combinations-sql">Combinations SQL</a> as described below</p></td>
</tr>
<tr class="row-odd"><td><p><strong>start vid</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td></td>
<td><p>Identifier of the starting vertex of the path.</p></td>
</tr>
<tr class="row-even"><td><p><strong>start vids</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ARRAY[BIGINT]</span></code></p></td>
<td></td>
<td><p>Array of identifiers of starting vertices.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>end vid</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td></td>
<td><p>Identifier of the ending vertex of the path.</p></td>
</tr>
<tr class="row-even"><td><p><strong>end vids</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ARRAY[BIGINT]</span></code></p></td>
<td></td>
<td><p>Array of identifiers of ending vertices.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>directed</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BOOLEAN</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">true</span></code></p></td>
<td><ul class="simple">
<li><p>When <code class="docutils literal notranslate"><span class="pre">true</span></code> Graph is considered <cite>Directed</cite></p></li>
<li><p>When <code class="docutils literal notranslate"><span class="pre">false</span></code> the graph is considered as <cite>Undirected</cite>.</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
</section>
<section id="inner-queries">
<h2><a class="toc-backref" href="#id12">Inner queries</a><a class="headerlink" href="#inner-queries" title="Enlazar permanentemente con este título">¶</a></h2>
<section id="edges-sql">
<h3><a class="toc-backref" href="#id13">Edges SQL</a><a class="headerlink" href="#edges-sql" title="Enlazar permanentemente con este título">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 12%" />
<col style="width: 14%" />
<col style="width: 6%" />
<col style="width: 69%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Descripción</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>id</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ANY-INTEGER</span></code></p></td>
<td></td>
<td><p>Identifier of the edge.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>source</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ANY-INTEGER</span></code></p></td>
<td></td>
<td><p>Identifier of the first end point vertex of the edge.</p></td>
</tr>
<tr class="row-even"><td><p><strong>target</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ANY-INTEGER</span></code></p></td>
<td></td>
<td><p>Identifier of the second end point vertex of the edge.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>cost</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ANY-NUMERICAL</span></code></p></td>
<td></td>
<td><p>Weight of the edge  <cite>(source, target)</cite></p>
<ul class="simple">
<li><p>When negative: edge <cite>(source, target)</cite> does not exist, therefore it’s not part of the graph.</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p><strong>reverse_cost</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ANY-NUMERICAL</span></code></p></td>
<td><p>-1</p></td>
<td><p>Weight of the edge <cite>(target, source)</cite>,</p>
<ul class="simple">
<li><p>When negative: edge <cite>(target, source)</cite> does not exist, therefore it’s not part of the graph.</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Where:</p>
<dl class="field-list simple">
<dt class="field-odd">ANY-INTEGER</dt>
<dd class="field-odd"><p>SMALLINT, INTEGER, BIGINT</p>
</dd>
<dt class="field-even">ANY-NUMERICAL</dt>
<dd class="field-even"><p>SMALLINT, INTEGER, BIGINT, REAL, FLOAT</p>
</dd>
</dl>
</section>
<section id="restrictions-sql">
<h3><a class="toc-backref" href="#id14">Restrictions SQL</a><a class="headerlink" href="#restrictions-sql" title="Enlazar permanentemente con este título">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 9%" />
<col style="width: 16%" />
<col style="width: 75%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Descripción</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>id</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ANY-INTEGER</span></code></p></td>
<td><p>Identifier of the restriction</p></td>
</tr>
<tr class="row-odd"><td><p><strong>path</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ARRAY[BIGINT]</span></code></p></td>
<td><p>Sequence of Edges identifiers that form a path that is not allowed to be taken</p></td>
</tr>
<tr class="row-even"><td><p><strong>Cost</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ANY-NUMERICAL</span></code></p></td>
<td><p>Cost of taking the forbidden path</p></td>
</tr>
</tbody>
</table>
<p>Where:</p>
<dl class="field-list simple">
<dt class="field-odd">ANY-INTEGER</dt>
<dd class="field-odd"><p>SMALLINT, INTEGER, BIGINT</p>
</dd>
<dt class="field-even">ANY-NUMERICAL</dt>
<dd class="field-even"><p>SMALLINT, INTEGER, BIGINT, REAL, FLOAT</p>
</dd>
</dl>
</section>
<section id="combinations-sql">
<h3><a class="toc-backref" href="#id15">Combinations SQL</a><a class="headerlink" href="#combinations-sql" title="Enlazar permanentemente con este título">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 17%" />
<col style="width: 19%" />
<col style="width: 8%" />
<col style="width: 56%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Descripción</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>source</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ANY-INTEGER</span></code></p></td>
<td></td>
<td><p>Identifier of the first end point vertex of the edge.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>target</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ANY-INTEGER</span></code></p></td>
<td></td>
<td><p>Identifier of the second end point vertex of the edge.</p></td>
</tr>
</tbody>
</table>
<p>Where:</p>
<dl class="field-list simple">
<dt class="field-odd">ANY-INTEGER</dt>
<dd class="field-odd"><p>SMALLINT, INTEGER, BIGINT</p>
</dd>
</dl>
</section>
</section>
<section id="return-columns">
<h2><a class="toc-backref" href="#id16">Return Columns</a><a class="headerlink" href="#return-columns" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Returns set of <code class="docutils literal notranslate"><span class="pre">(seq,</span> <span class="pre">path_id,</span> <span class="pre">path_seq</span> <span class="pre">[,</span> <span class="pre">start_vid]</span> <span class="pre">[,</span> <span class="pre">end_vid],</span> <span class="pre">node,</span> <span class="pre">edge,</span> <span class="pre">cost,</span> <span class="pre">agg_cost)</span></code></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 8%" />
<col style="width: 6%" />
<col style="width: 86%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Descripción</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>seq</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">INT</span></code></p></td>
<td><p>Sequential value starting from <strong>1</strong>.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>path_id</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">INT</span></code></p></td>
<td><p>Path identifier. Has value <strong>1</strong> for the first of a path. Used when there are multiple paths for the same <code class="docutils literal notranslate"><span class="pre">start_vid</span></code> to <code class="docutils literal notranslate"><span class="pre">end_vid</span></code> combination.</p></td>
</tr>
<tr class="row-even"><td><p><strong>path_seq</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">INT</span></code></p></td>
<td><p>Relative position in the path. Has value <strong>1</strong> for the beginning of a path.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>start_vid</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>Identifier of the starting vertex.
Returned when multiple starting vetrices are in the query.</p>
<ul class="simple">
<li><p><a class="reference internal" href="#many-to-one">Many to One</a></p></li>
<li><p><a class="reference internal" href="#many-to-many">Many to Many</a></p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p><strong>end_vid</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>Identifier of the ending vertex.
Returned when multiple ending vertices are in the query.</p>
<ul class="simple">
<li><p><a class="reference internal" href="#one-to-many">One to Many</a></p></li>
<li><p><a class="reference internal" href="#many-to-many">Many to Many</a></p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p><strong>node</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>Identifier of the node in the path from <code class="docutils literal notranslate"><span class="pre">start_vid</span></code> to <code class="docutils literal notranslate"><span class="pre">end_vid</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><strong>edge</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>Identifier of the edge used to go from <code class="docutils literal notranslate"><span class="pre">node</span></code> to the next node in the path sequence. <code class="docutils literal notranslate"><span class="pre">-1</span></code> for the last node of the path.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>cost</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">FLOAT</span></code></p></td>
<td><p>Cost to traverse from <code class="docutils literal notranslate"><span class="pre">node</span></code> using <code class="docutils literal notranslate"><span class="pre">edge</span></code> to the next node in the path sequence.</p></td>
</tr>
<tr class="row-even"><td><p><strong>agg_cost</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">FLOAT</span></code></p></td>
<td><p>Aggregate cost from <code class="docutils literal notranslate"><span class="pre">start_v</span></code> to <code class="docutils literal notranslate"><span class="pre">node</span></code>.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="version-2-1-signatures">
<h2><a class="toc-backref" href="#id17">Version 2.1 signatures</a><a class="headerlink" href="#version-2-1-signatures" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="highlight-sql notranslate" id="index-5"><div class="highlight"><pre><span></span><span class="n">pgr_trsp</span><span class="p">(</span><span class="k">sql</span><span class="w"> </span><span class="nb">text</span><span class="p">,</span><span class="w"> </span><span class="k">source</span><span class="w"> </span><span class="nb">integer</span><span class="p">,</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="nb">integer</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="n">directed</span><span class="w"> </span><span class="nb">boolean</span><span class="p">,</span><span class="w"> </span><span class="n">has_rcost</span><span class="w"> </span><span class="nb">boolean</span><span class="w"> </span><span class="p">[,</span><span class="n">restrict_sql</span><span class="w"> </span><span class="nb">text</span><span class="p">]);</span><span class="w"></span>
<span class="k">RETURNS</span><span class="w"> </span><span class="k">SETOF</span><span class="w"> </span><span class="p">(</span><span class="n">seq</span><span class="p">,</span><span class="w"> </span><span class="n">id1</span><span class="p">,</span><span class="w"> </span><span class="n">id2</span><span class="p">,</span><span class="w"> </span><span class="n">cost</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="n">pgr_trsp</span><span class="p">(</span><span class="k">sql</span><span class="w"> </span><span class="nb">text</span><span class="p">,</span><span class="w"> </span><span class="n">source_edge</span><span class="w"> </span><span class="nb">integer</span><span class="p">,</span><span class="w"> </span><span class="n">source_pos</span><span class="w"> </span><span class="n">float8</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="n">target_edge</span><span class="w"> </span><span class="nb">integer</span><span class="p">,</span><span class="w"> </span><span class="n">target_pos</span><span class="w"> </span><span class="n">float8</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="n">directed</span><span class="w"> </span><span class="nb">boolean</span><span class="p">,</span><span class="w"> </span><span class="n">has_rcost</span><span class="w"> </span><span class="nb">boolean</span><span class="w"> </span><span class="p">[,</span><span class="n">restrict_sql</span><span class="w"> </span><span class="nb">text</span><span class="p">]);</span><span class="w"></span>
<span class="k">RETURNS</span><span class="w"> </span><span class="k">SETOF</span><span class="w"> </span><span class="p">(</span><span class="n">seq</span><span class="p">,</span><span class="w"> </span><span class="n">id1</span><span class="p">,</span><span class="w"> </span><span class="n">id2</span><span class="p">,</span><span class="w"> </span><span class="n">cost</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="n">pgr_trspViaVertices</span><span class="p">(</span><span class="k">sql</span><span class="w"> </span><span class="nb">text</span><span class="p">,</span><span class="w"> </span><span class="n">vids</span><span class="w"> </span><span class="nb">integer</span><span class="p">[],</span><span class="w"></span>
<span class="w">                  </span><span class="n">directed</span><span class="w"> </span><span class="nb">boolean</span><span class="p">,</span><span class="w"> </span><span class="n">has_rcost</span><span class="w"> </span><span class="nb">boolean</span><span class="w"></span>
<span class="w">                  </span><span class="p">[,</span><span class="w"> </span><span class="n">turn_restrict_sql</span><span class="w"> </span><span class="nb">text</span><span class="p">]);</span><span class="w"></span>
<span class="k">RETURNS</span><span class="w"> </span><span class="k">SETOF</span><span class="w"> </span><span class="p">(</span><span class="n">seq</span><span class="p">,</span><span class="w"> </span><span class="n">id1</span><span class="p">,</span><span class="w"> </span><span class="n">id2</span><span class="p">,</span><span class="w"> </span><span class="n">id3</span><span class="p">,</span><span class="w"> </span><span class="n">cost</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="n">pgr_trspViaEdges</span><span class="p">(</span><span class="k">sql</span><span class="w"> </span><span class="nb">text</span><span class="p">,</span><span class="w"> </span><span class="n">eids</span><span class="w"> </span><span class="nb">integer</span><span class="p">[],</span><span class="w"> </span><span class="n">pcts</span><span class="w"> </span><span class="n">float8</span><span class="p">[],</span><span class="w"></span>
<span class="w">                  </span><span class="n">directed</span><span class="w"> </span><span class="nb">boolean</span><span class="p">,</span><span class="w"> </span><span class="n">has_rcost</span><span class="w"> </span><span class="nb">boolean</span><span class="w"></span>
<span class="w">                  </span><span class="p">[,</span><span class="w"> </span><span class="n">turn_restrict_sql</span><span class="w"> </span><span class="nb">text</span><span class="p">]);</span><span class="w"></span>
<span class="k">RETURNS</span><span class="w"> </span><span class="k">SETOF</span><span class="w"> </span><span class="p">(</span><span class="n">seq</span><span class="p">,</span><span class="w"> </span><span class="n">id1</span><span class="p">,</span><span class="w"> </span><span class="n">id2</span><span class="p">,</span><span class="w"> </span><span class="n">id3</span><span class="p">,</span><span class="w"> </span><span class="n">cost</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p><strong>Las características principales son:</strong></p>
<p>El algoritmo de la ruta más corta restringida por giro (TRSP) es similar a la estrella fugaz en que puede especificar restricciones de giro.</p>
<p>La configuración de TRSP es en su mayoría la misma que <a class="reference internal" href="pgr_dijkstra.html"><span class="doc">Dijkstra shortest path</span></a> con la adición de una tabla de restricción de giro opcional. Esto proporciona una manera fácil de agregar restricciones de giro a una red de carreteras colocándolas en una tabla separada.</p>
<dl class="field-list">
<dt class="field-odd">sql</dt>
<dd class="field-odd"><p>una consulta SQL que debe proporcionar un conjunto de registros con los siguientes campos:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="k">source</span><span class="p">,</span><span class="w"> </span><span class="n">target</span><span class="p">,</span><span class="w"> </span><span class="n">cost</span><span class="p">,</span><span class="w"> </span><span class="p">[,</span><span class="n">reverse_cost</span><span class="p">]</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">edge_table</span><span class="w"></span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">id</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">int4</span></code> Identificador del borde</p>
</dd>
<dt class="field-even">source</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">int4</span></code> Identificador del vértice inicial del borde</p>
</dd>
<dt class="field-odd">target</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">int4</span></code> Identificador del vértice final del borde</p>
</dd>
<dt class="field-even">Costo</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">float8</span></code>  Costo del recorrido sobre el borde. Un costo negativo evitará que el borde sea insertado en el gráfico.</p>
</dd>
<dt class="field-odd">reverse_cost</dt>
<dd class="field-odd"><p>(opcional) El costo para el recorrido inverso del borde. Esto sólo se utiliza cuando los parámetros <code class="docutils literal notranslate"><span class="pre">directed</span></code> y <code class="docutils literal notranslate"><span class="pre">has_rcost</span></code>  son <code class="docutils literal notranslate"><span class="pre">True</span></code> (ver el comentario anterior sobre los costos negativos).</p>
</dd>
</dl>
</dd>
<dt class="field-even">source</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">int4</span></code> <strong>identificador</strong> del nodo de partida</p>
</dd>
<dt class="field-odd">target</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">int4</span></code> <strong>identificador</strong> del nodo de llegada</p>
</dd>
<dt class="field-even">dirigido</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">true</span></code> Si la gráfica es direccionada</p>
</dd>
<dt class="field-odd">has_rcost</dt>
<dd class="field-odd"><p>Si  es <code class="docutils literal notranslate"><span class="pre">True</span></code>, el campo <code class="docutils literal notranslate"><span class="pre">reverse_cost</span></code>  del conjunto de registros generados se utilizan para el calcular el costo de la travesía del borde en la dirección opuesta.</p>
</dd>
<dt class="field-even">restrict_sql</dt>
<dd class="field-even"><p>(opcional) una consulta SQL, que debe proporcionar un conjunto de registros con los siguientes campos:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">to_cost</span><span class="p">,</span><span class="w"> </span><span class="n">target_id</span><span class="p">,</span><span class="w"> </span><span class="n">via_path</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">restrictions</span><span class="w"></span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">to_cost</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">float8</span></code> restricción del costo de giro</p>
</dd>
<dt class="field-even">target_id</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">int4</span></code> identificador del borde donde se aplica la restricción</p>
</dd>
<dt class="field-odd">via_path</dt>
<dd class="field-odd"><p>Lista de aristas <code class="docutils literal notranslate"><span class="pre">text</span></code> separadas por comas en el orden inverso de <code class="docutils literal notranslate"><span class="pre">rule</span></code></p>
</dd>
</dl>
</dd>
</dl>
<p>Otra variante de TRSP que permite especificar el <strong>Identificador del borde</strong> de partida y de llegada junto con una fracción para interpolar la posición:</p>
<dl class="field-list simple">
<dt class="field-odd">source_edge</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">int4</span></code> <strong>identificador del borde</strong> de partida</p>
</dd>
<dt class="field-even">source_pos</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">float8</span></code> fracción de 1 que define la posición del sobre el borde de partida.</p>
</dd>
<dt class="field-odd">target_edge</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">int4</span></code> <strong>Identificador del borde</strong> de llegada</p>
</dd>
<dt class="field-even">target_pos</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">float8</span></code> fracción de 1 que define la posición del sobre el borde de llegada.</p>
</dd>
</dl>
<p>Devuelve el conjunto de:</p>
<dl class="field-list simple">
<dt class="field-odd">seq</dt>
<dd class="field-odd"><p>Secuencia de registros</p>
</dd>
<dt class="field-even">id1</dt>
<dd class="field-even"><p>Identificador del nodo visitado</p>
</dd>
<dt class="field-odd">id2</dt>
<dd class="field-odd"><p>Identificador del borde (<code class="docutils literal notranslate"><span class="pre">-1</span></code> para el ultimo registro)</p>
</dd>
<dt class="field-even">Costo</dt>
<dd class="field-even"><p>costo para atravesar desde el nodo <code class="docutils literal notranslate"><span class="pre">id1</span></code>  usando el borde``id2`` hasta su otro extremo</p>
</dd>
</dl>
</section>
<section id="support-for-vias">
<h2><a class="toc-backref" href="#id18">Soporte para Vias</a><a class="headerlink" href="#support-for-vias" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>Las funciones de Soporte para Vias son prototipos. No se están considerando todos los casos de esquina.</p>
</div>
<p>También tenemos soporte para vias donde puedes generar una ruta de A a B a C, etc. Admitimos ambos métodos por encima de solo pasar un arreglo de vértices y/o un arreglo de aristas y la posición porcentual a lo largo de la arista en dos arreglos.</p>
<dl class="field-list">
<dt class="field-odd">sql</dt>
<dd class="field-odd"><p>una consulta SQL que debe proporcionar un conjunto de registros con los siguientes campos:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="k">source</span><span class="p">,</span><span class="w"> </span><span class="n">target</span><span class="p">,</span><span class="w"> </span><span class="n">cost</span><span class="p">,</span><span class="w"> </span><span class="p">[,</span><span class="n">reverse_cost</span><span class="p">]</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">edge_table</span><span class="w"></span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">id</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">int4</span></code> Identificador del borde</p>
</dd>
<dt class="field-even">source</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">int4</span></code> Identificador del vértice inicial del borde</p>
</dd>
<dt class="field-odd">target</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">int4</span></code> Identificador del vértice final del borde</p>
</dd>
<dt class="field-even">Costo</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">float8</span></code>  Costo del recorrido sobre el borde. Un costo negativo evitará que el borde sea insertado en el gráfico.</p>
</dd>
<dt class="field-odd">reverse_cost</dt>
<dd class="field-odd"><p>(opcional) El costo para el recorrido inverso del borde. Esto sólo se utiliza cuando los parámetros <code class="docutils literal notranslate"><span class="pre">directed</span></code> y <code class="docutils literal notranslate"><span class="pre">has_rcost</span></code>  son <code class="docutils literal notranslate"><span class="pre">True</span></code> (ver el comentario anterior sobre los costos negativos).</p>
</dd>
</dl>
</dd>
<dt class="field-even">vids</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">int4[]</span></code> Un arreglo ordenado de <strong>NODE id</strong> la ruta irá de principio a fin.</p>
</dd>
<dt class="field-odd">dirigido</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">true</span></code> Si la gráfica es direccionada</p>
</dd>
<dt class="field-even">has_rcost</dt>
<dd class="field-even"><p>Si  es <code class="docutils literal notranslate"><span class="pre">True</span></code>, el campo <code class="docutils literal notranslate"><span class="pre">reverse_cost</span></code>  del conjunto de registros generados se utilizan para el calcular el costo de la travesía del borde en la dirección opuesta.</p>
</dd>
<dt class="field-odd">restrict_sql</dt>
<dd class="field-odd"><p>(opcional) una consulta SQL, que debe proporcionar un conjunto de registros con los siguientes campos:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">to_cost</span><span class="p">,</span><span class="w"> </span><span class="n">target_id</span><span class="p">,</span><span class="w"> </span><span class="n">via_path</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">restrictions</span><span class="w"></span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">to_cost</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">float8</span></code> restricción del costo de giro</p>
</dd>
<dt class="field-even">target_id</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">int4</span></code> identificador del borde donde se aplica la restricción</p>
</dd>
<dt class="field-odd">via_path</dt>
<dd class="field-odd"><p>Lista de aristas `` text`` separadas por comas en el orden inverso de <code class="docutils literal notranslate"><span class="pre">rule</span></code></p>
</dd>
</dl>
</dd>
</dl>
<p>Otra variante de TRSP permite especificar <strong>EDGE id</strong> junto con una fracción para interpolar la posición:</p>
<dl class="field-list simple">
<dt class="field-odd">eids</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">int4</span></code> Un arreglo ordenado de <strong>EDGE id</strong> que la ruta tiene que atravesar</p>
</dd>
<dt class="field-even">Pct</dt>
<dd class="field-even"><p>`` float8`` Un arreglo de posiciones fraccionarias a lo largo de las respectivas aristasen  <code class="docutils literal notranslate"><span class="pre">eids</span></code>, donde 0.0 es el comienzo de la arista y 1.0 es el final.</p>
</dd>
</dl>
<p>Devuelve el conjunto de:</p>
<dl class="field-list simple">
<dt class="field-odd">seq</dt>
<dd class="field-odd"><p>Secuencia de registros</p>
</dd>
<dt class="field-even">id1</dt>
<dd class="field-even"><p>Identificador de la ruta</p>
</dd>
<dt class="field-odd">id2</dt>
<dd class="field-odd"><p>Identificador del nodo visitado</p>
</dd>
<dt class="field-even">id3</dt>
<dd class="field-even"><p>Identificador del borde (<code class="docutils literal notranslate"><span class="pre">-1</span></code> para el ultimo registro)</p>
</dd>
<dt class="field-odd">Costo</dt>
<dd class="field-odd"><p>costo para atravesar desde el nodo <code class="docutils literal notranslate"><span class="pre">id2</span></code>  usando el borde <code class="docutils literal notranslate"><span class="pre">id3</span></code> hasta su otro extremo</p>
</dd>
</dl>
</section>
<section id="additional-examples">
<h2><a class="toc-backref" href="#id19">Ejemplos Adicionales</a><a class="headerlink" href="#additional-examples" title="Enlazar permanentemente con este título">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">Ejemplo</dt>
<dd class="field-odd"><p>Sin restricción de giros</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">pgr_trsp</span><span class="p">(</span>
        <span class="s1">&#39;SELECT id::INTEGER, source::INTEGER, target::INTEGER, cost FROM edge_table&#39;</span><span class="p">,</span>
        <span class="mi">7</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="n">false</span><span class="p">,</span> <span class="n">false</span>
    <span class="p">);</span>
<span class="n">WARNING</span><span class="p">:</span>  <span class="n">This</span> <span class="n">signature</span> <span class="ow">is</span> <span class="n">been</span> <span class="n">deprecated</span>
 <span class="n">seq</span> <span class="o">|</span> <span class="n">id1</span> <span class="o">|</span> <span class="n">id2</span> <span class="o">|</span> <span class="n">cost</span>
<span class="o">-----+-----+-----+------</span>
   <span class="mi">0</span> <span class="o">|</span>   <span class="mi">7</span> <span class="o">|</span>   <span class="mi">6</span> <span class="o">|</span>    <span class="mi">1</span>
   <span class="mi">1</span> <span class="o">|</span>   <span class="mi">8</span> <span class="o">|</span>   <span class="mi">7</span> <span class="o">|</span>    <span class="mi">1</span>
   <span class="mi">2</span> <span class="o">|</span>   <span class="mi">5</span> <span class="o">|</span>   <span class="mi">8</span> <span class="o">|</span>    <span class="mi">1</span>
   <span class="mi">3</span> <span class="o">|</span>   <span class="mi">6</span> <span class="o">|</span>   <span class="mi">9</span> <span class="o">|</span>    <span class="mi">1</span>
   <span class="mi">4</span> <span class="o">|</span>   <span class="mi">9</span> <span class="o">|</span>  <span class="mi">15</span> <span class="o">|</span>    <span class="mi">1</span>
   <span class="mi">5</span> <span class="o">|</span>  <span class="mi">12</span> <span class="o">|</span>  <span class="o">-</span><span class="mi">1</span> <span class="o">|</span>    <span class="mi">0</span>
<span class="p">(</span><span class="mi">6</span> <span class="n">rows</span><span class="p">)</span>

</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Ejemplo</dt>
<dd class="field-odd"><p>Con restricción de giros</p>
</dd>
</dl>
<p>Entonces una consulta con restricciones de giro es creada de la siguiente forma:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">pgr_trsp</span><span class="p">(</span>
        <span class="s1">&#39;SELECT id::INTEGER, source::INTEGER, target::INTEGER, cost FROM edge_table&#39;</span><span class="p">,</span>
        <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">false</span><span class="p">,</span> <span class="n">false</span><span class="p">,</span>
        <span class="s1">&#39;SELECT to_cost, target_id::int4,</span>
        <span class="n">from_edge</span> <span class="o">||</span> <span class="n">coalesce</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span> <span class="o">||</span> <span class="n">via_path</span><span class="p">,</span> <span class="s1">&#39;&#39;&#39;&#39;) AS via_path</span>
<span class="s1">        FROM restrictions&#39;</span>
<span class="s1">    );</span>
<span class="s1">WARNING:  This signature is been deprecated</span>
<span class="s1"> seq | id1 | id2 | cost</span>
<span class="s1">-----+-----+-----+------</span>
<span class="s1">   0 |   2 |   4 |    1</span>
<span class="s1">   1 |   5 |  10 |    1</span>
<span class="s1">   2 |  10 |  12 |    1</span>
<span class="s1">   3 |  11 |  11 |    1</span>
<span class="s1">   4 |   6 |   8 |    1</span>
<span class="s1">   5 |   5 |   7 |    1</span>
<span class="s1">   6 |   8 |   6 |    1</span>
<span class="s1">   7 |   7 |  -1 |    0</span>
<span class="s1">(8 rows)</span>

<span class="s1">SELECT * FROM pgr_trsp(</span>
<span class="s1">        &#39;SELECT id::INTEGER, source::INTEGER, target::INTEGER, cost FROM edge_table&#39;,</span>
<span class="s1">        7, 11, false, false,</span>
<span class="s1">        &#39;SELECT to_cost, target_id::int4,</span>
<span class="s1">        from_edge || coalesce(&#39;&#39;,&#39;&#39; || via_path, &#39;&#39;&#39;&#39;) AS via_path</span>
        <span class="n">FROM</span> <span class="n">restrictions</span><span class="s1">&#39;</span>
    <span class="p">);</span>
<span class="n">WARNING</span><span class="p">:</span>  <span class="n">This</span> <span class="n">signature</span> <span class="ow">is</span> <span class="n">been</span> <span class="n">deprecated</span>
 <span class="n">seq</span> <span class="o">|</span> <span class="n">id1</span> <span class="o">|</span> <span class="n">id2</span> <span class="o">|</span> <span class="n">cost</span>
<span class="o">-----+-----+-----+------</span>
   <span class="mi">0</span> <span class="o">|</span>   <span class="mi">7</span> <span class="o">|</span>   <span class="mi">6</span> <span class="o">|</span>    <span class="mi">1</span>
   <span class="mi">1</span> <span class="o">|</span>   <span class="mi">8</span> <span class="o">|</span>   <span class="mi">7</span> <span class="o">|</span>    <span class="mi">1</span>
   <span class="mi">2</span> <span class="o">|</span>   <span class="mi">5</span> <span class="o">|</span>   <span class="mi">8</span> <span class="o">|</span>    <span class="mi">1</span>
   <span class="mi">3</span> <span class="o">|</span>   <span class="mi">6</span> <span class="o">|</span>   <span class="mi">9</span> <span class="o">|</span>    <span class="mi">1</span>
   <span class="mi">4</span> <span class="o">|</span>   <span class="mi">9</span> <span class="o">|</span>  <span class="mi">15</span> <span class="o">|</span>    <span class="mi">1</span>
   <span class="mi">5</span> <span class="o">|</span>  <span class="mi">12</span> <span class="o">|</span>  <span class="mi">13</span> <span class="o">|</span>    <span class="mi">1</span>
   <span class="mi">6</span> <span class="o">|</span>  <span class="mi">11</span> <span class="o">|</span>  <span class="o">-</span><span class="mi">1</span> <span class="o">|</span>    <span class="mi">0</span>
<span class="p">(</span><span class="mi">7</span> <span class="n">rows</span><span class="p">)</span>

</pre></div>
</div>
<p>Una consulta de ejemplo mediante identificadores de vértices y puntos de vía:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">pgr_trspViaVertices</span><span class="p">(</span>
        <span class="s1">&#39;SELECT id::INTEGER, source::INTEGER, target::INTEGER, cost FROM edge_table&#39;</span><span class="p">,</span>
        <span class="n">ARRAY</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="p">]::</span><span class="n">INTEGER</span><span class="p">[],</span>
        <span class="n">false</span><span class="p">,</span>  <span class="n">false</span><span class="p">,</span>
        <span class="s1">&#39;SELECT to_cost, target_id::int4, from_edge ||</span>
        <span class="n">coalesce</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="o">||</span><span class="n">via_path</span><span class="p">,</span><span class="s1">&#39;&#39;&#39;&#39;) AS via_path FROM restrictions&#39;);</span>
<span class="s1"> seq | id1 | id2 | id3 | cost</span>
<span class="s1">-----+-----+-----+-----+------</span>
<span class="s1">   1 |   1 |   2 |   4 |    1</span>
<span class="s1">   2 |   1 |   5 |  10 |    1</span>
<span class="s1">   3 |   1 |  10 |  12 |    1</span>
<span class="s1">   4 |   1 |  11 |  11 |    1</span>
<span class="s1">   5 |   1 |   6 |   8 |    1</span>
<span class="s1">   6 |   1 |   5 |   7 |    1</span>
<span class="s1">   7 |   1 |   8 |   6 |    1</span>
<span class="s1">   8 |   2 |   7 |   6 |    1</span>
<span class="s1">   9 |   2 |   8 |   7 |    1</span>
<span class="s1">  10 |   2 |   5 |   8 |    1</span>
<span class="s1">  11 |   2 |   6 |   9 |    1</span>
<span class="s1">  12 |   2 |   9 |  15 |    1</span>
<span class="s1">  13 |   2 |  12 |  13 |    1</span>
<span class="s1">  14 |   2 |  11 |  -1 |    0</span>
<span class="s1">(14 rows)</span>

</pre></div>
</div>
<p>Una consulta de ejemplo mediante identificadores de borde y vias:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">pgr_trspViaEdges</span><span class="p">(</span>
        <span class="s1">&#39;SELECT id::INTEGER, source::INTEGER, target::INTEGER, cost,</span>
        <span class="n">reverse_cost</span> <span class="n">FROM</span> <span class="n">edge_table</span><span class="s1">&#39;,</span>
        <span class="n">ARRAY</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="p">]::</span><span class="n">INTEGER</span><span class="p">[],</span>
        <span class="n">ARRAY</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]::</span><span class="n">FLOAT</span><span class="p">[],</span>
        <span class="n">true</span><span class="p">,</span>
        <span class="n">true</span><span class="p">,</span>
        <span class="s1">&#39;SELECT to_cost, target_id::int4, FROM_edge ||</span>
        <span class="n">coalesce</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="o">||</span><span class="n">via_path</span><span class="p">,</span><span class="s1">&#39;&#39;&#39;&#39;) AS via_path FROM restrictions&#39;);</span>
<span class="s1"> seq | id1 | id2 | id3 | cost</span>
<span class="s1">-----+-----+-----+-----+------</span>
<span class="s1">   1 |   1 |  -1 |   2 |  0.5</span>
<span class="s1">   2 |   1 |   2 |   4 |    1</span>
<span class="s1">   3 |   1 |   5 |   8 |    1</span>
<span class="s1">   4 |   1 |   6 |   9 |    1</span>
<span class="s1">   5 |   1 |   9 |  16 |    1</span>
<span class="s1">   6 |   1 |   4 |   3 |    1</span>
<span class="s1">   7 |   1 |   3 |   5 |    1</span>
<span class="s1">   8 |   1 |   6 |   8 |    1</span>
<span class="s1">   9 |   1 |   5 |   7 |    1</span>
<span class="s1">  10 |   2 |   5 |   8 |    1</span>
<span class="s1">  11 |   2 |   6 |   9 |    1</span>
<span class="s1">  12 |   2 |   9 |  16 |    1</span>
<span class="s1">  13 |   2 |   4 |   3 |    1</span>
<span class="s1">  14 |   2 |   3 |   5 |    1</span>
<span class="s1">  15 |   2 |   6 |  11 |  0.5</span>
<span class="s1">(15 rows)</span>

</pre></div>
</div>
<p>Las consultas utilizan la red  <a class="reference internal" href="sampledata.html"><span class="doc">Datos Muestra</span></a> .</p>
</section>
<section id="known-issues">
<h2><a class="toc-backref" href="#id20">Problemas conocidos</a><a class="headerlink" href="#known-issues" title="Enlazar permanentemente con este título">¶</a></h2>
<section id="introduction">
<h3><a class="toc-backref" href="#id21">Introducción</a><a class="headerlink" href="#introduction" title="Enlazar permanentemente con este título">¶</a></h3>
<p>el código pgr_trsp tiene problemas que aún no se están solucionando, pero a medida que pasa el tiempo y se agrega nueva funcionalidad a pgRouting, hay contenedores para <strong>ocultar</strong> los problemas, no para solucionarlos.</p>
<p>Para mayor claridad en las consultas:</p>
<ul class="simple">
<li><p>_pgr_trsp (internal_function) es el código original</p></li>
<li><p>pgr_trsp (minúscula) representa el contenedor que convoca al código original</p></li>
<li><p>pgr_TRSP (mayúsculas) representa el contenedor que convoca a la función de reemplazo. Dependiendo de esa función, puede ser:</p>
<ul>
<li><p>pgr_dijkstra</p></li>
<li><p>pgr_dijkstraVia</p></li>
<li><p>pgr_withPoints</p></li>
<li><p>_pgr_withPointsVia (función interna)</p></li>
</ul>
</li>
</ul>
</section>
<section id="the-restrictions">
<h3><a class="toc-backref" href="#id22">Las restricciones</a><a class="headerlink" href="#the-restrictions" title="Enlazar permanentemente con este título">¶</a></h3>
<p>La restricción utilizada en los ejemplos no tiene que ver nada con el grafo:</p>
<ul class="simple">
<li><p>Ningún vértice tiene id: 25, 32 o 33</p></li>
<li><p>Ninguna arista tiene id: 25, 32 o 33</p></li>
</ul>
<p>For these notes, the restriction is that the sequence of edges 33 -&gt; 32 -&gt; 25 can not be taken in that sequence, and if
taken the cost is 100.</p>
<p>The restriction on the V2.1 signatures are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="mi">100</span><span class="p">::</span><span class="nb">float</span> <span class="n">AS</span> <span class="n">to_cost</span><span class="p">,</span> <span class="mi">25</span><span class="p">::</span><span class="n">INTEGER</span> <span class="n">AS</span> <span class="n">target_id</span><span class="p">,</span> <span class="s1">&#39;32, 33&#39;</span><span class="p">::</span><span class="n">TEXT</span> <span class="n">AS</span> <span class="n">via_path</span><span class="p">;</span>
 <span class="n">to_cost</span> <span class="o">|</span> <span class="n">target_id</span> <span class="o">|</span> <span class="n">via_path</span>
<span class="o">---------+-----------+----------</span>
     <span class="mi">100</span> <span class="o">|</span>        <span class="mi">25</span> <span class="o">|</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">33</span>
<span class="p">(</span><span class="mi">1</span> <span class="n">row</span><span class="p">)</span>

</pre></div>
</div>
<p>Note that:
* <cite>via_path</cite> column is text
* in <cite>via_path</cite> the ordering of the edges is reversed from what is the intention
* target_id is the last edge of the restriction</p>
<p>The same restriction on the new proposed functions is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="mi">1</span> <span class="n">AS</span> <span class="nb">id</span><span class="p">,</span> <span class="mi">100</span> <span class="n">AS</span> <span class="n">cost</span><span class="p">,</span> <span class="n">ARRAY</span><span class="p">[</span><span class="mi">33</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">25</span><span class="p">]</span> <span class="n">AS</span> <span class="n">path</span><span class="p">;</span>
 <span class="nb">id</span> <span class="o">|</span> <span class="n">cost</span> <span class="o">|</span>    <span class="n">path</span>
<span class="o">----+------+------------</span>
  <span class="mi">1</span> <span class="o">|</span>  <span class="mi">100</span> <span class="o">|</span> <span class="p">{</span><span class="mi">33</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">25</span><span class="p">}</span>
<span class="p">(</span><span class="mi">1</span> <span class="n">row</span><span class="p">)</span>

</pre></div>
</div>
<p>por lo tanto, la ruta más corta esperado es como si no hubiera ninguna restricción involucrada</p>
</section>
<section id="the-vertices-signature-version-deprecated-on-v3-4">
<h3><a class="toc-backref" href="#id23">The «Vertices» signature version – deprecated on v3.4</a><a class="headerlink" href="#the-vertices-signature-version-deprecated-on-v3-4" title="Enlazar permanentemente con este título">¶</a></h3>
<p>The following signature</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="n">pgr_trsp</span><span class="p">(</span><span class="k">sql</span><span class="w"> </span><span class="nb">text</span><span class="p">,</span><span class="w"> </span><span class="k">source</span><span class="w"> </span><span class="nb">integer</span><span class="p">,</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="nb">integer</span><span class="p">,</span><span class="w"></span>
<span class="w">         </span><span class="n">directed</span><span class="w"> </span><span class="nb">boolean</span><span class="p">,</span><span class="w"> </span><span class="n">has_rcost</span><span class="w"> </span><span class="nb">boolean</span><span class="w"> </span><span class="p">[,</span><span class="n">restrict_sql</span><span class="w"> </span><span class="nb">text</span><span class="p">]);</span><span class="w"></span>
</pre></div>
</div>
<p>is substitued with <a class="reference internal" href="pgr_dijkstra.html"><span class="doc">pgr_dijkstra</span></a> when there are no restrictions,
and with pgr_trsp(<a class="reference internal" href="#one-to-one">One to One</a>) when there are restrictions.</p>
<section id="different-ways-to-represent-no-path-found">
<h4><a class="toc-backref" href="#id24">Diferentes formas de representar “ninguna ruta encontrada”</a><a class="headerlink" href="#different-ways-to-represent-no-path-found" title="Enlazar permanentemente con este título">¶</a></h4>
<ul class="simple">
<li><p>A veces se representa con EMPTY SET ninguna ruta encontrada</p></li>
<li><p>A veces representa con ERROR ninguna ruta encontrada</p></li>
</ul>
<p class="rubric">Se devuelve EMPTY SET para representar ninguna ruta encontrada</p>
<p>There is no restrictions query.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT * FROM pgr_trsp(
  $$SELECT id::INTEGER, source::INTEGER, target::INTEGER, cost, reverse_cost  FROM edge_table$$,
  1, 15, true, true
);
WARNING:  This signature is been deprecated
 seq | id1 | id2 | cost
-----+-----+-----+------
(0 rows)

</pre></div>
</div>
<p class="rubric">Se producirá una  EXCEPCIÓN para representar ninguna ruta encontrada</p>
<p>There is a restrictions query, even when the restrictions have nothing to do with the graph.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT * FROM pgr_trsp(
  $$SELECT id::INTEGER, source::INTEGER, target::INTEGER, cost, reverse_cost  FROM edge_table$$,
  1, 15, true, true,
  $$SELECT 100::float AS to_cost, 25::INTEGER AS target_id, &#39;32, 33&#39;::TEXT AS via_path$$
);
WARNING:  This signature is been deprecated
ERROR:  Error computing path: Path Not Found
CONTEXT:  PL/pgSQL function pgr_trsp(text,integer,integer,boolean,boolean,text) line 54 at RAISE
</pre></div>
</div>
<p class="rubric">Solving the problem.</p>
<p>When there are no restrictions <a class="reference internal" href="pgr_dijkstra.html"><span class="doc">pgr_dijkstra</span></a> should be used.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT * FROM pgr_dijkstra(
  $$SELECT id, source, target, cost, reverse_cost FROM edge_table$$,
  1, 15
);
 seq | path_seq | node | edge | cost | agg_cost
-----+----------+------+------+------+----------
(0 rows)

</pre></div>
</div>
<p>When there are restrictions the proposed pgr_trsp(<a class="reference internal" href="#one-to-one">One to One</a>) should be used.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT * FROM pgr_trsp(
  $$SELECT id, source, target, cost, reverse_cost FROM edge_table$$,
  $$SELECT 1 AS id, 100 AS cost, ARRAY[33, 32, 25] AS path$$,
  1, 15
);
 seq | path_seq | start_vid | end_vid | node | edge | cost | agg_cost
-----+----------+-----------+---------+------+------+------+----------
(0 rows)

</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Ejemplo</dt>
<dd class="field-odd"><p>Routing from/to same location without restrictions</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT * FROM pgr_dijkstra(
  $$SELECT id, source, target, cost, reverse_cost FROM edge_table$$,
  1, 1
);
 seq | path_seq | node | edge | cost | agg_cost
-----+----------+------+------+------+----------
(0 rows)

</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Ejemplo</dt>
<dd class="field-odd"><p>Routing from/to same location with restrictions</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT * FROM pgr_trsp(
  $$SELECT id, source, target, cost, reverse_cost FROM edge_table$$,
  $$SELECT 1 AS id, 100 AS cost, ARRAY[33, 32, 25] AS path$$,
  1, 1
);
 seq | path_seq | start_vid | end_vid | node | edge | cost | agg_cost
-----+----------+-----------+---------+------+------+------+----------
(0 rows)

</pre></div>
</div>
</section>
<section id="user-contradictions">
<h4><a class="toc-backref" href="#id25">Contradicciones de usuarios</a><a class="headerlink" href="#user-contradictions" title="Enlazar permanentemente con este título">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">pgr_trsp</span></code> a diferencia de otras funciones de pgRouting no detecta automáticamente la existencia de la columna <code class="docutils literal notranslate"><span class="pre">reverse_cost</span></code>. Por lo tanto, tiene el parámetro <code class="docutils literal notranslate"><span class="pre">has_rcost</span></code> para verificar la existencia de la columna <code class="docutils literal notranslate"><span class="pre">reverse_cost</span></code>. Las contradicciones suceden:</p>
<ul class="simple">
<li><p>When the <code class="docutils literal notranslate"><span class="pre">reverse_cost</span></code> is missing, and the flag <code class="docutils literal notranslate"><span class="pre">has_rcost</span></code> is set to true</p></li>
<li><p>When the <code class="docutils literal notranslate"><span class="pre">reverse_cost</span></code> exists, and the flag <code class="docutils literal notranslate"><span class="pre">has_rcost</span></code> is set to false</p></li>
</ul>
<p class="rubric">In an undirected graph, when <code class="docutils literal notranslate"><span class="pre">reverse_cost</span></code> is missing, and the flag <code class="docutils literal notranslate"><span class="pre">has_rcost</span></code> is set to true.</p>
<p>An EXCEPTION is thrown as the contradiction can not be solved.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT * FROM pgr_trsp(
    $$SELECT id::INTEGER, source::INTEGER, target::INTEGER, cost FROM edge_table$$,
    2, 3, false, true,
    $$SELECT 100::float AS to_cost, 25::INTEGER AS target_id, &#39;32, 33&#39;::TEXT AS via_path$$
);
WARNING:  This signature is been deprecated
ERROR:  Error, reverse_cost is used, but query did&#39;t return &#39;reverse_cost&#39; column
CONTEXT:  PL/pgSQL function pgr_trsp(text,integer,integer,boolean,boolean,text) line 25 at RAISE
</pre></div>
</div>
<p class="rubric">In an undirected graph, when the <code class="docutils literal notranslate"><span class="pre">reverse_cost</span></code> exists, and the flag <code class="docutils literal notranslate"><span class="pre">has_rcost</span></code> is set to false</p>
<p>The <code class="docutils literal notranslate"><span class="pre">reverse_cost</span></code> column will be effectively removed and take execution time</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT * FROM pgr_trsp(
    $$SELECT id::INTEGER, source::INTEGER, target::INTEGER, cost, reverse_cost FROM edge_table$$,
    2, 3, false, false,
    $$SELECT 100::float AS to_cost, 25::INTEGER AS target_id, &#39;32, 33&#39;::TEXT AS via_path$$
);
WARNING:  This signature is been deprecated
 seq | id1 | id2 | cost
-----+-----+-----+------
   0 |   2 |   4 |    1
   1 |   5 |   8 |    1
   2 |   6 |   5 |    1
   3 |   3 |  -1 |    0
(4 rows)

</pre></div>
</div>
<p class="rubric">Solving the problem.</p>
<p>In an undirected graph, with the <code class="docutils literal notranslate"><span class="pre">reverse_cost</span></code> column.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT * FROM pgr_dijkstra(
  $$SELECT id, source, target, cost, reverse_cost FROM edge_table$$,
  2, 3, false
);
 seq | path_seq | node | edge | cost | agg_cost
-----+----------+------+------+------+----------
   1 |        1 |    2 |    2 |    1 |        0
   2 |        2 |    3 |   -1 |    0 |        1
(2 rows)

</pre></div>
</div>
<p>In an undirected graph, without the <code class="docutils literal notranslate"><span class="pre">reverse_cost</span></code> column.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT * FROM pgr_trsp(
  $$SELECT id, source, target, cost FROM edge_table$$,
  $$SELECT 1 AS id, 100 AS cost, ARRAY[33, 32, 25] AS path$$,
  2, 3, false
);
 seq | path_seq | start_vid | end_vid | node | edge | cost | agg_cost
-----+----------+-----------+---------+------+------+------+----------
   1 |        1 |         2 |       3 |    2 |    4 |    1 |        0
   2 |        2 |         2 |       3 |    5 |    8 |    1 |        1
   3 |        3 |         2 |       3 |    6 |    5 |    1 |        2
   4 |        4 |         2 |       3 |    3 |   -1 |    0 |        3
(4 rows)

</pre></div>
</div>
</section>
</section>
<section id="the-edges-signature-version">
<h3><a class="toc-backref" href="#id26">La versión de firma «Edges»</a><a class="headerlink" href="#the-edges-signature-version" title="Enlazar permanentemente con este título">¶</a></h3>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="n">pgr_trsp</span><span class="p">(</span><span class="k">sql</span><span class="w"> </span><span class="nb">text</span><span class="p">,</span><span class="w"> </span><span class="n">source_edge</span><span class="w"> </span><span class="nb">integer</span><span class="p">,</span><span class="w"> </span><span class="n">source_pos</span><span class="w"> </span><span class="n">float8</span><span class="p">,</span><span class="w"></span>
<span class="w">         </span><span class="n">target_edge</span><span class="w"> </span><span class="nb">integer</span><span class="p">,</span><span class="w"> </span><span class="n">target_pos</span><span class="w"> </span><span class="n">float8</span><span class="p">,</span><span class="w"></span>
<span class="w">         </span><span class="n">directed</span><span class="w"> </span><span class="nb">boolean</span><span class="p">,</span><span class="w"> </span><span class="n">has_rcost</span><span class="w"> </span><span class="nb">boolean</span><span class="w"> </span><span class="p">[,</span><span class="n">restrict_sql</span><span class="w"> </span><span class="nb">text</span><span class="p">]);</span><span class="w"></span>
</pre></div>
</div>
<section id="id1">
<h4><a class="toc-backref" href="#id27">Diferentes formas de representar “ninguna ruta encontrada”</a><a class="headerlink" href="#id1" title="Enlazar permanentemente con este título">¶</a></h4>
<ul class="simple">
<li><p>A veces se representa con EMPTY SET ninguna ruta encontrada</p></li>
<li><p>A veces se representa con EXCEPCIÓN ninguna ruta encontrada</p></li>
</ul>
<p class="rubric">Se devuelve EMPTY SET para representar ninguna ruta encontrada</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT * FROM pgr_trsp(
    $$SELECT id::INTEGER, source::INTEGER, target::INTEGER, cost, reverse_cost  FROM edge_table$$,
    1, 0.5, 17, 0.5, true, true
);
 seq | id1 | id2 | cost
-----+-----+-----+------
(0 rows)

</pre></div>
</div>
<p>pgr_trsp invoca <a class="reference internal" href="pgr_withPoints.html"><span class="doc">pgr_withPoints - Propuesto</span></a> cuando no hay restricciones que devuelvan <cite>EMPTY SET</cite> cuando no se encuentra una ruta</p>
<p class="rubric">Se producirá una  EXCEPCIÓN para representar ninguna ruta encontrada</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT * FROM _pgr_trsp(
    $$SELECT id::INTEGER, source::INTEGER, target::INTEGER, cost, reverse_cost  FROM edge_table$$,
    1, 0.5, 17, 0.5, true, true,
    $$SELECT 100::float AS to_cost, 25::INTEGER AS target_id, &#39;32, 33&#39;::TEXT AS via_path$$
);
ERROR:  Error computing path: Path Not Found
</pre></div>
</div>
<p>pgr_trsp utiliza el código original cuando hay restricciones, incluso si no tienen nada que ver con el grafo, lo que producirá una EXCEPCIÓN para representar ninguna ruta encontrada.</p>
</section>
<section id="paths-with-equal-number-of-vertices-and-edges">
<h4><a class="toc-backref" href="#id28">Rutas con igual número de vértices y aristas</a><a class="headerlink" href="#paths-with-equal-number-of-vertices-and-edges" title="Enlazar permanentemente con este título">¶</a></h4>
<p>Una ruta se conforma por <cite>N</cite> vértices y <cite>N - 1</cite> aristas.</p>
<ul class="simple">
<li><p>A veces devuelve <cite>N</cite> vértices y <cite>N - 1</cite> aristas.</p></li>
<li><p>A veces se devuelven <cite>N - 1</cite> vértices y <cite>N - 1</cite> aristas.</p></li>
</ul>
<p class="rubric">Retorno de <cite>N</cite> vértices y <cite>N - 1</cite> aristas.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT * FROM pgr_TRSP(
    $$SELECT id::INTEGER, source::INTEGER, target::INTEGER, cost, reverse_cost  FROM edge_table$$,
    1, 0.5, 1, 0.8, true, true
);
 seq | id1 | id2 | cost
-----+-----+-----+------
   0 |  -1 |   1 |  0.3
   1 |  -2 |  -1 |    0
(2 rows)

</pre></div>
</div>
<p>pgr_trsp convoca a <a class="reference internal" href="pgr_withPoints.html"><span class="doc">pgr_withPoints - Propuesto</span></a> cuando no hay restricciones que devuelvan el número correcto de filas que incluirán todos los vértices. La última fila tendrá un <code class="docutils literal notranslate"><span class="pre">-1</span></code> en la columna de aristas para indicar que el número de arista es inválido para esa fila.</p>
<p class="rubric">Retorno de <cite>N - 1</cite> vrtices’y <cite>N - 1</cite> aristas.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT * FROM pgr_TRSP(
    $$SELECT id::INTEGER, source::INTEGER, target::INTEGER, cost, reverse_cost  FROM edge_table$$,
    1, 0.5, 1, 0.8, true, true,
    $$SELECT 100::float AS to_cost, 25::INTEGER AS target_id, &#39;32, 33&#39;::TEXT AS via_path$$
);
 seq | id1 | id2 | cost
-----+-----+-----+------
   0 |  -1 |   1 |  0.3
(1 row)

</pre></div>
</div>
<p>pgr_trsp utiliza el código original cuando hay restricciones, incluso si no tienen nada que ver con el grafo, y no devolverán el último vértice de la ruta.</p>
</section>
<section id="routing-from-to-same-location">
<h4><a class="toc-backref" href="#id29">Ruteo desde/hacia la misma ubicación</a><a class="headerlink" href="#routing-from-to-same-location" title="Enlazar permanentemente con este título">¶</a></h4>
<p>Al enrutar desde la misma arista y posición a la misma arista y posición, no se necesita ninguna ruta para llegar al destino, pues ya está allí. Por lo tanto, se espera que devuelva un <cite>EMPTY SET</cite> o una <cite>EXCEPTION</cite> dependiendo de los parámetros, ninguno de los cuales está sucediendo.</p>
<p class="rubric">Una ruta con 2 vértices y coste de arista 0</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT * FROM pgr_TRSP(
    $$SELECT id::INTEGER, source::INTEGER, target::INTEGER, cost, reverse_cost  FROM edge_table$$,
    1, 0.5, 1, 0.5, true, true
);
 seq | id1 | id2 | cost
-----+-----+-----+------
   0 |  -1 |   1 |    0
   1 |  -2 |  -1 |    0
(2 rows)

</pre></div>
</div>
<p>pgr_trsp convoca a <a class="reference internal" href="pgr_withPoints.html"><span class="doc">pgr_withPoints - Propuesto</span></a> configurando la primera <span class="math notranslate nohighlight">\((arista, posición)\)</span> con un diferente id de punto de la segunda <span class="math notranslate nohighlight">\((arista, posición)\)</span> haciendo de ellas diferentes puntos. Pero el costo usando la arista es de <span class="math notranslate nohighlight">\(0\)</span>.</p>
<p class="rubric">Una ruta con 1 vértice y coste de arista 0</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT * FROM pgr_TRSP(
    $$SELECT id::INTEGER, source::INTEGER, target::INTEGER, cost, reverse_cost  FROM edge_table$$,
    1, 0.5, 1, 0.5, true, true,
    $$SELECT 100::float AS to_cost, 25::INTEGER AS target_id, &#39;32, 33&#39;::TEXT AS via_path$$
);
 seq | id1 | id2 | cost
-----+-----+-----+------
   0 |  -1 |   1 |    0
(1 row)

</pre></div>
</div>
<p>pgr_trsp utiliza el código original cuando hay restricciones, incluso si no tienen nada que ver con el grafo, y no tendrán la fila para el vértice <span class="math notranslate nohighlight">\(-2\)</span>.</p>
</section>
<section id="id2">
<h4><a class="toc-backref" href="#id30">Contradicciones de usuarios</a><a class="headerlink" href="#id2" title="Enlazar permanentemente con este título">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">pgr_trsp</span></code> a diferencia de otras funciones de pgRouting no detecta automáticamente la existencia de la columna <code class="docutils literal notranslate"><span class="pre">reverse_cost</span></code>. Por lo tanto, tiene el parámetro <code class="docutils literal notranslate"><span class="pre">has_rcost</span></code> para verificar la existencia de la columna <code class="docutils literal notranslate"><span class="pre">reverse_cost</span></code>. Las contradicciones suceden:</p>
<ul class="simple">
<li><p>Cuando falta reverse_cost, y la marca <cite>has_rcost</cite> se establece como verdadera</p></li>
<li><p>Cuando el reverse_cost existe, y el indicador <cite>has_rcost</cite> se establece en false</p></li>
</ul>
<p class="rubric">Cuando falta reverse_cost y el indicador <cite>has_rcost</cite> se configura como verdadero.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT * FROM pgr_trsp(
    $$SELECT id::INTEGER, source::INTEGER, target::INTEGER, cost FROM edge_table$$,
    1, 0.5, 1, 0.8, false, true,
    $$SELECT 100::float AS to_cost, 25::INTEGER AS target_id, &#39;32, 33&#39;::TEXT AS via_path$$
);
ERROR:  Error, reverse_cost is used, but query did&#39;t return &#39;reverse_cost&#39; column
CONTEXT:  PL/pgSQL function pgr_trsp(text,integer,double precision,integer,double precision,boolean,boolean,text) line 36 at RAISE
</pre></div>
</div>
<p>Se produce una EXCEPCIÓN.</p>
<p class="rubric">Cuando el reverse_cost existe, y el indicador <cite>has_rcost</cite> se establece en false</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT * FROM pgr_trsp(
    $$SELECT id::INTEGER, source::INTEGER, target::INTEGER, cost, reverse_cost FROM edge_table$$,
    1, 0.5, 1, 0.8, false, false,
    $$SELECT 100::float AS to_cost, 25::INTEGER AS target_id, &#39;32, 33&#39;::TEXT AS via_path$$
);
 seq | id1 | id2 | cost
-----+-----+-----+------
   0 |  -1 |   1 |  0.3
(1 row)

</pre></div>
</div>
<p>La columna de <code class="docutils literal notranslate"><span class="pre">reverse_cost</span></code> será eliminada efectivamente y costará tiempo de ejecución</p>
</section>
<section id="using-a-points-of-interest-table">
<h4><a class="toc-backref" href="#id31">Uso de una tabla de puntos de interés</a><a class="headerlink" href="#using-a-points-of-interest-table" title="Enlazar permanentemente con este título">¶</a></h4>
<p>Dado un conjunto de puntos de interés:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">pointsOfInterest</span><span class="p">;</span>
 <span class="n">pid</span> <span class="o">|</span>  <span class="n">x</span>  <span class="o">|</span>  <span class="n">y</span>  <span class="o">|</span> <span class="n">edge_id</span> <span class="o">|</span> <span class="n">side</span> <span class="o">|</span> <span class="n">fraction</span> <span class="o">|</span>                  <span class="n">the_geom</span>                  <span class="o">|</span>                  <span class="n">newpoint</span>
<span class="o">-----+-----+-----+---------+------+----------+--------------------------------------------+--------------------------------------------</span>
   <span class="mi">1</span> <span class="o">|</span> <span class="mf">1.8</span> <span class="o">|</span> <span class="mf">0.4</span> <span class="o">|</span>       <span class="mi">1</span> <span class="o">|</span> <span class="n">l</span>    <span class="o">|</span>      <span class="mf">0.4</span> <span class="o">|</span> <span class="mi">0101000000</span><span class="n">CDCCCCCCCCCCFC3F9A9999999999D93F</span> <span class="o">|</span> <span class="mi">010100000000000000000000409</span><span class="n">A9999999999D93F</span>
   <span class="mi">2</span> <span class="o">|</span> <span class="mf">4.2</span> <span class="o">|</span> <span class="mf">2.4</span> <span class="o">|</span>      <span class="mi">15</span> <span class="o">|</span> <span class="n">r</span>    <span class="o">|</span>      <span class="mf">0.4</span> <span class="o">|</span> <span class="mi">0101000000</span><span class="n">CDCCCCCCCCCC10403333333333330340</span> <span class="o">|</span> <span class="mi">010100000000000000000010403333333333330340</span>
   <span class="mi">3</span> <span class="o">|</span> <span class="mf">2.6</span> <span class="o">|</span> <span class="mf">3.2</span> <span class="o">|</span>      <span class="mi">12</span> <span class="o">|</span> <span class="n">l</span>    <span class="o">|</span>      <span class="mf">0.6</span> <span class="o">|</span> <span class="mi">0101000000</span><span class="n">CDCCCCCCCCCC04409A99999999990940</span> <span class="o">|</span> <span class="mi">0101000000</span><span class="n">CDCCCCCCCCCC04400000000000000840</span>
   <span class="mi">4</span> <span class="o">|</span> <span class="mf">0.3</span> <span class="o">|</span> <span class="mf">1.8</span> <span class="o">|</span>       <span class="mi">6</span> <span class="o">|</span> <span class="n">r</span>    <span class="o">|</span>      <span class="mf">0.3</span> <span class="o">|</span> <span class="mi">0101000000333333333333</span><span class="n">D33FCDCCCCCCCCCCFC3F</span> <span class="o">|</span> <span class="mi">0101000000333333333333</span><span class="n">D33F0000000000000040</span>
   <span class="mi">5</span> <span class="o">|</span> <span class="mf">2.9</span> <span class="o">|</span> <span class="mf">1.8</span> <span class="o">|</span>       <span class="mi">5</span> <span class="o">|</span> <span class="n">l</span>    <span class="o">|</span>      <span class="mf">0.8</span> <span class="o">|</span> <span class="mi">01010000003333333333330740</span><span class="n">CDCCCCCCCCCCFC3F</span> <span class="o">|</span> <span class="mi">01010000000000000000000840</span><span class="n">CDCCCCCCCCCCFC3F</span>
   <span class="mi">6</span> <span class="o">|</span> <span class="mf">2.2</span> <span class="o">|</span> <span class="mf">1.7</span> <span class="o">|</span>       <span class="mi">4</span> <span class="o">|</span> <span class="n">b</span>    <span class="o">|</span>      <span class="mf">0.7</span> <span class="o">|</span> <span class="mi">01010000009</span><span class="n">A99999999990140333333333333FB3F</span> <span class="o">|</span> <span class="mi">01010000000000000000000040333333333333</span><span class="n">FB3F</span>
<span class="p">(</span><span class="mi">6</span> <span class="n">rows</span><span class="p">)</span>

</pre></div>
</div>
<p class="rubric">Uso de pgr_trsp</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT * FROM pgr_TRSP(
    $$SELECT id::INTEGER, source::INTEGER, target::INTEGER, cost, reverse_cost  FROM edge_table$$,
    (SELECT edge_id::INTEGER  FROM pointsOfInterest WHERE pid = 1),
    (SELECT fraction  FROM pointsOfInterest WHERE pid = 1),
    (SELECT edge_id::INTEGER  FROM pointsOfInterest WHERE pid = 6),
    (SELECT fraction  FROM pointsOfInterest WHERE pid = 6),
    true, true,
    $$SELECT 100::float AS to_cost, 25::INTEGER AS target_id, &#39;32, 33&#39;::TEXT AS via_path$$
);
 seq | id1 | id2 | cost
-----+-----+-----+------
   0 |  -1 |   1 |  0.6
   1 |   2 |   4 |  0.7
(2 rows)

</pre></div>
</div>
<p>En <em>pgr_trsp</em>, para poder utilizar la información de la tabla:</p>
<ul class="simple">
<li><p>Cada parámetro debe extraerse explícitamente de la tabla</p></li>
<li><p>Independientemente del punto pid valor original</p>
<ul>
<li><p>siempre será -1 para el primer punto</p></li>
<li><p>siempre será -2 para el segundo punto</p>
<ul>
<li><p>la fila que alcanza el punto -2 no se mostrará</p></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="rubric">Uso de <a class="reference internal" href="pgr_withPoints.html"><span class="doc">pgr_withPoints - Propuesto</span></a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT * FROM pgr_withPoints(
    $$SELECT id::INTEGER, source::INTEGER, target::INTEGER, cost, reverse_cost  FROM edge_table$$,
    $$SELECT pid, edge_id, fraction FROM pointsOfInterest$$,
    -1, -6
);
 seq | path_seq | node | edge | cost | agg_cost
-----+----------+------+------+------+----------
   1 |        1 |   -1 |    1 |  0.6 |        0
   2 |        2 |    2 |    4 |  0.7 |      0.6
   3 |        3 |   -6 |   -1 |    0 |      1.3
(3 rows)

</pre></div>
</div>
<p>Sugerencia: use <a class="reference internal" href="pgr_withPoints.html"><span class="doc">pgr_withPoints - Propuesto</span></a> cuando no hay restricciones de giro:</p>
<ul class="simple">
<li><p>Los resultados son más completos</p></li>
<li><p>Los nombres de columna son significativos</p></li>
</ul>
</section>
<section id="routing-from-a-vertex-to-a-point">
<h4><a class="toc-backref" href="#id32">Ruteo desde un vértice a un punto</a><a class="headerlink" href="#routing-from-a-vertex-to-a-point" title="Enlazar permanentemente con este título">¶</a></h4>
<p>Resolver una ruta más corta desde el vértice <span class="math notranslate nohighlight">\(6\)</span> a pid 1 usando una tabla de puntos de interés</p>
<p class="rubric">Uso de pgr_trsp</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT * FROM pgr_trsp(
    $$SELECT id::INTEGER, source::INTEGER, target::INTEGER, cost, reverse_cost FROM edge_table$$,
    8, 1,
    (SELECT edge_id::INTEGER  FROM pointsOfInterest WHERE pid = 1),
    (SELECT fraction  FROM pointsOfInterest WHERE pid = 1),
    true, true,
    $$SELECT 100::float AS to_cost, 25::INTEGER AS target_id, &#39;32, 33&#39;::TEXT AS via_path$$
);
 seq | id1 | id2 | cost
-----+-----+-----+------
   0 |   6 |   8 |    1
   1 |   5 |   4 |    1
   2 |   2 |   1 |  0.6
(3 rows)

</pre></div>
</div>
<ul class="simple">
<li><p>El vértice 6 está en el borde 8 en 1 fracción</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT * FROM pgr_trsp(
    $$SELECT id::INTEGER, source::INTEGER, target::INTEGER, cost, reverse_cost FROM edge_table$$,
    11, 0,
    (SELECT edge_id::INTEGER  FROM pointsOfInterest WHERE pid = 1),
    (SELECT fraction  FROM pointsOfInterest WHERE pid = 1),
    true, true,
    $$SELECT 100::float AS to_cost, 25::INTEGER AS target_id, &#39;32, 33&#39;::TEXT AS via_path$$
);
 seq | id1 | id2 | cost
-----+-----+-----+------
   0 |   6 |   8 |    1
   1 |   5 |   4 |    1
   2 |   2 |   1 |  0.6
(3 rows)

</pre></div>
</div>
<ul class="simple">
<li><p>El vértice 6 es también borde 11 en 0 fracción</p></li>
</ul>
<p class="rubric">Uso de <a class="reference internal" href="pgr_withPoints.html"><span class="doc">pgr_withPoints - Propuesto</span></a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT * FROM pgr_withPoints(
    $$SELECT id::INTEGER, source::INTEGER, target::INTEGER, cost, reverse_cost  FROM edge_table$$,
    $$SELECT pid, edge_id, fraction FROM pointsOfInterest$$,
    6, -1
);
 seq | path_seq | node | edge | cost | agg_cost
-----+----------+------+------+------+----------
   1 |        1 |    6 |    8 |    1 |        0
   2 |        2 |    5 |    4 |    1 |        1
   3 |        3 |    2 |    1 |  0.6 |        2
   4 |        4 |   -1 |   -1 |    0 |      2.6
(4 rows)

</pre></div>
</div>
<p>Sugerencia: use <a class="reference internal" href="pgr_withPoints.html"><span class="doc">pgr_withPoints - Propuesto</span></a> cuando no hay restricciones de giro:</p>
<ul class="simple">
<li><p>No es necesario elegir dónde se encuentra el vértice.</p></li>
<li><p>Los resultados son más completos</p></li>
<li><p>Los nombres de columna son significativos</p></li>
</ul>
</section>
</section>
<section id="prototypes">
<h3><a class="toc-backref" href="#id33">Prototipos</a><a class="headerlink" href="#prototypes" title="Enlazar permanentemente con este título">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">pgr_trspViaVertices</span></code> y <code class="docutils literal notranslate"><span class="pre">pgr_trspViaEdges</span></code> fueron añadidas como prototipos</p>
<p>Estas funciones utilizan las funciones pgr_trsp heredando todos los problemas mencionados anteriormente. Cuando no hay restricciones y tienen un problema de ruteo «vía» con vértices:</p>
<ul class="simple">
<li><p><a class="reference internal" href="pgr_dijkstraVia.html"><span class="doc">pgr_dijkstraVia - Propuesto</span></a></p></li>
</ul>
</section>
</section>
<section id="see-also">
<h2><a class="toc-backref" href="#id34">Ver también</a><a class="headerlink" href="#see-also" title="Enlazar permanentemente con este título">¶</a></h2>
<p class="rubric">Índices y tablas</p>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Índice</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Página de Búsqueda</span></a></p></li>
</ul>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright pgRouting Contributors - Version v3.4.0-dev.<br/>
      Actualizado por última vez en ene. 19, 2022.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.4.0.<br/>
    </p>
  </div>
</footer>
  </body>
</html>